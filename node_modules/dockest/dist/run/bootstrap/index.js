"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const configureLogger_1 = require("./configureLogger");
const getParsedComposeFile_1 = require("./getParsedComposeFile");
const mergeComposeFiles_1 = require("./mergeComposeFiles");
const setupExitHandler_1 = require("./setupExitHandler");
const transformDockestServicesToRunners_1 = require("./transformDockestServicesToRunners");
const writeComposeFile_1 = require("./writeComposeFile");
const createDockerEventEmitter_1 = require("./createDockerEventEmitter");
exports.bootstrap = async ({ composeFile, dockestServices, dumpErrors, exitHandler, runMode, mutables, perfStart, }) => {
    setupExitHandler_1.setupExitHandler({ dumpErrors, exitHandler, mutables, perfStart });
    const { mergedComposeFiles } = await mergeComposeFiles_1.mergeComposeFiles({ composeFile });
    const { dockerComposeFile } = getParsedComposeFile_1.getParsedComposeFile(mergedComposeFiles);
    const composeFilePath = writeComposeFile_1.writeComposeFile(mergedComposeFiles, dockerComposeFile);
    const dockerEventEmitter = createDockerEventEmitter_1.createDockerEventEmitter(composeFilePath);
    mutables.runners = transformDockestServicesToRunners_1.transformDockestServicesToRunners({
        dockerComposeFile,
        dockestServices,
        runMode,
        dockerEventEmitter,
    });
    mutables.dockerEventEmitter = dockerEventEmitter;
    configureLogger_1.configureLogger(mutables.runners);
};
//# sourceMappingURL=index.js.map