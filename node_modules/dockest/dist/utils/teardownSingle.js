"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const execaWrapper_1 = require("./execaWrapper");
const Errors_1 = require("../Errors");
const stopContainerById = async ({ runner, runner: { containerId } }) => {
    const command = `docker stop ${containerId}`;
    await execaWrapper_1.execaWrapper(command, { runner, logPrefix: '[Stop Container]', logStdout: true });
};
const removeContainerById = async ({ runner, runner: { containerId } }) => {
    const command = `docker rm ${containerId} --volumes`;
    await execaWrapper_1.execaWrapper(command, { runner, logPrefix: '[Remove Container]', logStdout: true });
};
exports.teardownSingle = async ({ runner, runner: { containerId, dependents, serviceName }, }) => {
    if (!containerId) {
        throw new Errors_1.DockestError(`Invalid containerId (${containerId}) for service (${serviceName})`, { runner });
    }
    for (const dependant of dependents) {
        await exports.teardownSingle({ runner: dependant });
    }
    await stopContainerById({ runner });
    await removeContainerById({ runner });
};
//# sourceMappingURL=teardownSingle.js.map